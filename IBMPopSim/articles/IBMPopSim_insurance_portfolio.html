<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Insurance portfolio • IBMPopSim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Insurance portfolio">
<meta property="og:description" content="IBMPopSim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IBMPopSim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/IBMPopSim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/IBMPopSim_cpp.html">C++ essentials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IBMPopSim_human_pop.html">Human population</a>
    </li>
    <li>
      <a href="../articles/IBMPopSim_human_pop_IMD.html">Human population with swap</a>
    </li>
    <li>
      <a href="../articles/IBMPopSim_insurance_portfolio.html">Insurance portfolio</a>
    </li>
    <li>
      <a href="../articles/IBMPopSim_interaction.html">Population with genetically variable traits</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DaphneGiorgi/IBMPopSim/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="IBMPopSim_insurance_portfolio_files/header-attrs-2.2/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Insurance portfolio</h1>
                        <h4 class="author">Daphné Giorgi</h4>
                        <h4 class="author">Sarah Kaakaï</h4>
                        <h4 class="author">Vincent Lemaire</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DaphneGiorgi/IBMPopSim/blob/master/vignettes/IBMPopSim_insurance_portfolio.Rmd"><code>vignettes/IBMPopSim_insurance_portfolio.Rmd</code></a></small>
      <div class="hidden name"><code>IBMPopSim_insurance_portfolio.Rmd</code></div>

    </div>

    
    
<!-- #region -->
<p>This vignette provides an example of usage of the package IBMPopSim, for simulating an heterogeneous life insurance portfolio.</p>
<div id="example-description" class="section level1" number="1">
<h1 class="hasAnchor">
<a href="#example-description" class="anchor"></a><span class="header-section-number">1</span> Example description</h1>
<p>We consider a insurance portfolio composed of males in two risk classes (for instance smokers vs non smokers), and where policyholders are characterized by their age and risk class.</p>
<p>Entries and exit to/from the portfolio are modeled by Poissonian events, and individual can die with an intensity depending on their age and risk class.
<!-- #endregion --></p>
</div>
<div id="population-creation" class="section level1" number="2">
<h1 class="hasAnchor">
<a href="#population-creation" class="anchor"></a><span class="header-section-number">2</span> Population creation</h1>
<p>We start with an initial population of 30 000 males of age 65, distributed uniformly in each risk class.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">pop_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"birth"</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(-<span class="fl">65</span>,<span class="fl">3e4</span>),<span class="st">"death"</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fl">3e4</span>),<span class="st">"risk_cls"</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="kw">each</span><span class="kw">=</span> <span class="fl">15000</span>))</pre></body></html></div>
</div>
<div id="model-parameters" class="section level1" number="3">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="death-intensity" class="section level2" number="3.1">
<h2 class="hasAnchor">
<a href="#death-intensity" class="anchor"></a><span class="header-section-number">3.1</span> Death intensity</h2>
<p>Death intensities are calibrated on England and Wales males mortality data (source: Human Mortality Database), forecasted over t=30 years by a Lee-Carter model with the package <code>StMoMo</code>.</p>
<p>Individuals in the risk class 1 are assumed to have mortality rates 20% higher that the forecasted mortality rates and individuals in the risk class 2 are assumed to have mortality rates 10% lower than the forecasted rates.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">EWStMoMoMale</span> <span class="kw">&lt;-</span> <span class="fu">StMoMoData</span>(<span class="no">EWdata_hmd</span>, <span class="kw">series</span> <span class="kw">=</span> <span class="st">"male"</span>)

<span class="co">#Fitting</span>
<span class="no">LC</span> <span class="kw">&lt;-</span> <span class="fu">lc</span>()
<span class="no">ages.fit</span> <span class="kw">&lt;-</span> <span class="fl">0</span>:<span class="fl">100</span>
<span class="no">years.fit</span> <span class="kw">&lt;-</span> <span class="fl">1950</span>:<span class="fl">2016</span>
<span class="no">LCfitMale</span> <span class="kw">&lt;-</span> <span class="fu">fit</span>(<span class="no">LC</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">EWStMoMoMale</span>, <span class="kw">ages.fit</span> <span class="kw">=</span> <span class="no">ages.fit</span>, <span class="kw">years.fit</span> <span class="kw">=</span> <span class="no">years.fit</span>)
<span class="co">## StMoMo: Start fitting with gnm</span>
<span class="co">## Initialising</span>
<span class="co">## Running start-up iterations..</span>
<span class="co">## Running main iterations.........</span>
<span class="co">## Done</span>
<span class="co">## StMoMo: Finish fitting with gnm</span></pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">t</span> <span class="kw">&lt;-</span> <span class="fl">30</span></pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">LCforecastMale</span> <span class="kw">&lt;-</span> <span class="fu">forecast</span>(<span class="no">LCfitMale</span>, <span class="kw">h</span> <span class="kw">=</span> <span class="no">t</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">LCforecastMale</span>)</pre></body></html></div>
<p><img src="IBMPopSim_insurance_portfolio_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">list_death_male</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">LCforecastMale</span>$<span class="no">rates</span>, <span class="fl">2</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/stats/stepfun.html">stepfun</a></span>(<span class="fl">1</span>:<span class="fl">100</span>, <span class="no">x</span>))
<span class="no">breaks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">29</span>)
<span class="no">death_male</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/piecewise_xy.html">piecewise_xy</a></span>(<span class="no">breaks</span>,<span class="no">list_death_male</span>)
<span class="no">death_female</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/piecewise_xy.html">piecewise_xy</a></span>(<span class="no">breaks</span>,<span class="no">list_death_female</span>)</pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu">death_male</span>(<span class="fl">5</span>,<span class="fl">60</span>) <span class="co"># temps en premier age en deuxième</span>
<span class="co">## [1] 0.006457236</span></pre></body></html></div>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">params</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"death_male"</span><span class="kw">=</span> <span class="no">death_male</span>, <span class="st">"alpha"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>,<span class="fl">0.8</span>))</pre></body></html></div>
</div>
<div id="entry-and-exit-event" class="section level2" number="3.2">
<h2 class="hasAnchor">
<a href="#entry-and-exit-event" class="anchor"></a><span class="header-section-number">3.2</span> Entry and exit event</h2>
<p>Intensity of Poissonian entries/exit in the Portfolio</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">params</span>$<span class="no">lambda</span> <span class="kw">&lt;-</span> <span class="fl">5000</span>
<span class="no">params</span>$<span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">200</span></pre></body></html></div>
</div>
</div>
<div id="events-creation" class="section level1" number="4">
<h1 class="hasAnchor">
<a href="#events-creation" class="anchor"></a><span class="header-section-number">4</span> Events creation</h1>
<div id="death-events-creation" class="section level2" number="4.1">
<h2 class="hasAnchor">
<a href="#death-events-creation" class="anchor"></a><span class="header-section-number">4.1</span> Death events creation</h2>
<p>The vector parameter <code>alpha</code> will be transformed into a C++ vector (with index starting at 0) during the model creation, and <code>death_male</code> into a C++ function.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">death_event</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mk_event_individual.html">mk_event_individual</a></span>(
    <span class="kw">type</span> <span class="kw">=</span> <span class="st">"death"</span>,
    <span class="kw">intensity_code</span> <span class="kw">=</span> <span class="st">"result = alpha[I.risk_cls -1]*death_male(t,age(I, t));"</span>
)</pre></body></html></div>
</div>
<div id="entry-event-creation" class="section level2" number="4.2">
<h2 class="hasAnchor">
<a href="#entry-event-creation" class="anchor"></a><span class="header-section-number">4.2</span> Entry event creation</h2>
<p>New policyholders enter the population at a constant rate <span class="math inline">\(\lambda\)</span> (on average, <span class="math inline">\(\lambda\)</span> individuals enter the portfolio each year). A new individual entering the population is in risk class 1 with probability <span class="math inline">\(p=0.4\)</span> and his age is determined by a normally distributed random variable of mean 75 and variance 4.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">entry_event</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mk_event_poisson.html">mk_event_poisson</a></span>(
    <span class="kw">type</span> <span class="kw">=</span> <span class="st">"entry"</span>,
    <span class="kw">intensity</span> <span class="kw">=</span> <span class="st">"lambda"</span>,
    <span class="kw">kernel_code</span> <span class="kw">=</span> <span class="st">"if (CUnif()&lt;0.4) 
                        newI.risk_cls =1; 
                   else 
                        newI.risk_cls= 2; 
                   double a = CNorm(75,2); 
                   newI.set_age(a,t);"</span>
)</pre></body></html></div>
</div>
<div id="exit-events-creation" class="section level2" number="4.3">
<h2 class="hasAnchor">
<a href="#exit-events-creation" class="anchor"></a><span class="header-section-number">4.3</span> Exit events creation</h2>
<p>Policyholder can also exit the portofolio at a constant rate <span class="math inline">\(\mu\)</span> (on average, <span class="math inline">\(\mu\)</span> individuals enter the portfolio each year). In the presence of events of type <code>exit</code> in the population, a characteristic named <code>out</code> is automatically added, set to <code>FALSE</code> by default.<br>
When an individual leave the population, his characteristics <code>out</code>is set to <code>TRUE</code> and the date at which he exited the population is recorded in the column <code>death</code>.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">exit_event</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mk_event_poisson.html">mk_event_poisson</a></span>(
    <span class="kw">type</span> <span class="kw">=</span> <span class="st">"exit"</span>,
    <span class="kw">intensity</span> <span class="kw">=</span> <span class="st">"mu"</span>
)</pre></body></html></div>
</div>
</div>
<div id="model-creation" class="section level1" number="5">
<h1 class="hasAnchor">
<a href="#model-creation" class="anchor"></a><span class="header-section-number">5</span> Model creation</h1>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mk_model.html">mk_model</a></span>(
    <span class="kw">characteristics</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_characteristics.html">get_characteristics</a></span>(<span class="no">pop_df</span>),<span class="co"># Characteristics names ant type</span>
    <span class="kw">events</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">death_event</span>,<span class="no">entry_event</span>, <span class="no">exit_event</span>), <span class="co"># Events list</span>
    <span class="kw">parameters</span> <span class="kw">=</span> <span class="no">params</span> <span class="co"># Model parameters </span>
)
<span class="co">## [1] "exit event: add 'out' as individual attributes"</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">model</span>)
<span class="co">## Events:</span>
<span class="co">## #1: individual event of type death</span>
<span class="co">## #2: poisson event of type entry</span>
<span class="co">## #3: poisson event of type exit</span>
<span class="co">## --------------------------------------- </span>
<span class="co">## Individual description:</span>
<span class="co">## names:  birth death risk_cls out </span>
<span class="co">## R types:  double double integer logical </span>
<span class="co">## C types:  double double int bool</span>
<span class="co">## --------------------------------------- </span>
<span class="co">## R parameters available in C++ code:</span>
<span class="co">## names:  death_male alpha lambda mu </span>
<span class="co">## R types:  closure vector double double </span>
<span class="co">## C types:  function_xy arma::vec double double</span></pre></body></html></div>
</div>
<div id="simulation" class="section level1" number="6">
<h1 class="hasAnchor">
<a href="#simulation" class="anchor"></a><span class="header-section-number">6</span> Simulation</h1>
<div id="computation-of-event-intensity-bounds" class="section level2" number="6.1">
<h2 class="hasAnchor">
<a href="#computation-of-event-intensity-bounds" class="anchor"></a><span class="header-section-number">6.1</span> Computation of event intensity bounds</h2>
<p>(needed for acceptance/rejection algorithm)</p>
<p>For events with Poisson (constant) intensity, the bound is simply the intensity.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">death_max</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">list_death_male</span>, <span class="kw">function</span>(<span class="no">x</span>){<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">x</span>)}))</pre></body></html></div>
</div>
<div id="simulation-1" class="section level2" number="6.2">
<h2 class="hasAnchor">
<a href="#simulation-1" class="anchor"></a><span class="header-section-number">6.2</span> Simulation</h2>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">sim_out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/popsim.html">popsim</a></span>(<span class="kw">model</span> <span class="kw">=</span> <span class="no">model</span>,
    <span class="kw">population</span> <span class="kw">=</span><span class="no">pop_df</span>,
    <span class="kw">events_bounds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'death'</span> <span class="kw">=</span> <span class="no">death_max</span>, <span class="st">"entry"</span><span class="kw">=</span><span class="no">params</span>$<span class="no">lambda</span>, <span class="st">"exit"</span><span class="kw">=</span><span class="no">params</span>$<span class="no">mu</span>),
    <span class="kw">parameters</span> <span class="kw">=</span> <span class="no">params</span>,
    <span class="kw">time</span> <span class="kw">=</span> <span class="no">t</span>,
    <span class="kw">age_max</span> <span class="kw">=</span> <span class="fl">110</span>,
    <span class="kw">multithreading</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">## Warning in popsim(model = model, population = pop_df, events_bounds = c(death =</span>
<span class="co">## death_max, : Add 'out' attributes to the population.</span>
<span class="co">## Simulation on  [0, 30]</span></pre></body></html></div>
<p><strong>Ratio of accepted events</strong></p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">sim_out</span>$<span class="no">logs</span><span class="kw">[[</span><span class="st">"effective_events"</span>]] / <span class="no">sim_out</span>$<span class="no">logs</span><span class="kw">[[</span><span class="st">"proposed_events"</span>]]
<span class="co">## [1] 0.2450621</span></pre></body></html></div>
</div>
</div>
<div id="outputs" class="section level1" number="7">
<h1 class="hasAnchor">
<a href="#outputs" class="anchor"></a><span class="header-section-number">7</span> Outputs</h1>
<p><code>sim_out$population</code> is a data frame composed of all individuals present in the portfolio over the period [0,t] (individuals in the initial population and who entered the portofolio). Each line corresponds to an individual, with his date of birth, date of death (<code>NA</code> if still alive at the end of the simulation), risk class, and the characteristic <code>out</code>.<br>
The characteristics <code>out</code> is set to <code>TRUE</code> for individuals who left the portfolio due to an exit event.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">sim_out</span>$<span class="no">population</span>)
<span class="co">## 'data.frame':    179987 obs. of  4 variables:</span>
<span class="co">##  $ birth   : num  -65 -65 -65 -65 -65 -65 -65 -65 -65 -65 ...</span>
<span class="co">##  $ death   : num  NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">##  $ risk_cls: int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">##  $ out     : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span></pre></body></html></div>
<p>The function <code>age_pyramid</code>computes the age pyramid of a population data frame at a given time.</p>
<div id="age-pyramids" class="section level2" number="7.1">
<h2 class="hasAnchor">
<a href="#age-pyramids" class="anchor"></a><span class="header-section-number">7.1</span> Age pyramids</h2>
<p><span style="color:red"> problème avec age breaks dans plot_pyramid</span>
<span style="color:red"> il faut mettre les indices mais peut etre que ce n’est pas clair dans la doc, tu preferes qu’on mettes les ages ?</span></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">pyr</span> <span class="kw">=</span> <span class="fu"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(<span class="no">sim_out</span>$<span class="no">population</span>, <span class="kw">time</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">ages</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">65</span>:<span class="fl">100</span>,<span class="fl">Inf</span>))
<span class="fu"><a href="../reference/plot_pyramid.html">plot_pyramid</a></span>(<span class="no">pyr</span>, <span class="kw">age_breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>,<span class="fl">36</span>,<span class="kw">by</span><span class="kw">=</span><span class="fl">5</span>))) <span class="co">#seq(65,100,5)))</span></pre></body></html></div>
<p><img src="IBMPopSim_insurance_portfolio_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="life-tables" class="section level2" number="7.2">
<h2 class="hasAnchor">
<a href="#life-tables" class="anchor"></a><span class="header-section-number">7.2</span> Life tables</h2>
<p><span style="color:red"> corriger la fonction death table</span></p>
</div>
</div>
<div id="different-simulations-with-the-same-model" class="section level1" number="8">
<h1 class="hasAnchor">
<a href="#different-simulations-with-the-same-model" class="anchor"></a><span class="header-section-number">8</span> Different simulations with the same model</h1>
<p>The initial population and model parameters can be modified without have to recompile the model, in order to simulate the population model with different input. The event bounds must be modified accordingly before running again the simulation.</p>
<p>See <span style="color:red"> vignette human pop</span> for several examples.</p>
<!-- #region -->
</div>
<div id="brouillon-vignette-human-pop" class="section level1" number="9">
<h1 class="hasAnchor">
<a href="#brouillon-vignette-human-pop" class="anchor"></a><span class="header-section-number">9</span> BROUILLON VIGNETTE HUMAN POP</h1>
<div id="death-and-exposure-table" class="section level2" number="9.1">
<h2 class="hasAnchor">
<a href="#death-and-exposure-table" class="anchor"></a><span class="header-section-number">9.1</span> Death and exposure table</h2>
<p>The number of death for given age groups, time periods and for each cause of death can be computed with <code>death_table</code>.
<!-- #endregion --></p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"># For each cause: number of death from males of age between [70,90] (single year of age groups) over the 5-year period [15,20]
#Dx_1 &lt;- death_table(subset(sim_out_CoD$population, CoD==1 &amp; male==T),ages = 70:90, times = c(15,20))
#Dx_2 &lt;- death_table(subset(sim_out_CoD$population, CoD==2 &amp; male==T),ages = 70:90, times = c(15,20))</pre></body></html></div>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">Ex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/exposure_table.html">exposure_table</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">sim_out_CoD</span>$<span class="no">population</span>, <span class="no">male</span><span class="kw">==</span><span class="no">T</span>),<span class="kw">ages</span> <span class="kw">=</span> <span class="fl">70</span>:<span class="fl">90</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">15</span>,<span class="fl">20</span>)) <span class="co"># Central exposure to risk</span>
<span class="no">mx_1</span> <span class="kw">&lt;-</span> <span class="no">Dx_1</span>/<span class="no">Ex</span> <span class="co"># Males central death rates by for Cause 1</span>
<span class="no">mx_2</span> <span class="kw">&lt;-</span> <span class="no">Dx_2</span>/<span class="no">Ex</span></pre></body></html></div>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">70</span>:<span class="fl">89</span>,<span class="no">mx_1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"b"</span>,<span class="kw">main</span><span class="kw">=</span><span class="st">"Crude central death rate and true death intensity from cause 1"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fl">70</span>:<span class="fl">89</span>,<span class="no">params</span>$<span class="no">CoD1_prop</span>*<span class="no">params</span>$<span class="fu">death_male</span>(<span class="fl">70</span>:<span class="fl">89</span>),<span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
</div>
</div>
<div id="to-do-poisson-inhomogène" class="section level1" number="10">
<h1 class="hasAnchor">
<a href="#to-do-poisson-inhomog%C3%A8ne" class="anchor"></a><span class="header-section-number">10</span> TO DO : poisson inhomogène</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daphné Giorgi, Sarah Kakaai, Vincent Lemaire.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
